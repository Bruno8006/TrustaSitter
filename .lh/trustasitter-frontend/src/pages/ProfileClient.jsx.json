{
    "sourceFile": "trustasitter-frontend/src/pages/ProfileClient.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 16,
            "patches": [
                {
                    "date": 1751209680178,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1751209998906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,8 +62,26 @@\n             placeholder=\"Phone Number\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n \r\n+          {/* Region */}\r\n+          <select className=\"w-full px-4 py-2 border rounded focus:outline-none\">\r\n+            <option value=\"\">Select Region</option>\r\n+            <option value=\"Central\">Central</option>\r\n+            <option value=\"East\">East</option>\r\n+            <option value=\"West\">West</option>\r\n+            <option value=\"North\">North</option>\r\n+            <option value=\"South\">South</option>\r\n+          </select>\r\n+\r\n+          {/* Number of Children */}\r\n+          <input\r\n+            type=\"number\"\r\n+            min=\"1\"\r\n+            placeholder=\"Number of Children\"\r\n+            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+          />\r\n+\r\n           {/* Change Password */}\r\n           <div className=\"border-t pt-4 mt-4\">\r\n             <h2 className=\"text-lg font-semibold mb-2\">Change Password</h2>\r\n             <input\r\n"
                },
                {
                    "date": 1751247852290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,101 +1,163 @@\n-// src/pages/ProfileClient.jsx\r\n import React, { useState, useContext } from \"react\";\r\n import { FaCheckCircle } from \"react-icons/fa\";\r\n import { AuthContext } from \"../context/AuthContext\";\r\n import { useNavigate } from \"react-router-dom\";\r\n-import axios from \"axios\";\r\n+import { updateClientProfile, deleteClientAccount } from \"../services/api\";\r\n \r\n const ProfileClient = () => {\r\n+  const { user, token, logout } = useContext(AuthContext);\r\n+  const navigate = useNavigate();\r\n+\r\n+  const [formData, setFormData] = useState({\r\n+    name: user?.name || \"\",\r\n+    email: user?.email || \"\",\r\n+    phone: \"\",\r\n+    region: \"\",\r\n+    children: \"\",\r\n+    currentPassword: \"\",\r\n+    newPassword: \"\",\r\n+    confirmPassword: \"\",\r\n+  });\r\n+\r\n   const [showSuccess, setShowSuccess] = useState(false);\r\n   const [showConfirm, setShowConfirm] = useState(false);\r\n-  const { token, logout } = useContext(AuthContext);\r\n-  const navigate = useNavigate();\r\n+  const [error, setError] = useState(\"\");\r\n \r\n-  // Handle profile update (mock for now)\r\n-  const handleSubmit = (e) => {\r\n+  const handleChange = (e) => {\r\n+    const { name, value } = e.target;\r\n+    setFormData((prev) => ({ ...prev, [name]: value }));\r\n+  };\r\n+\r\n+  const handleSubmit = async (e) => {\r\n     e.preventDefault();\r\n-    setShowSuccess(true);\r\n-    setTimeout(() => setShowSuccess(false), 3000);\r\n+    setError(\"\");\r\n+\r\n+    if (formData.newPassword && formData.newPassword !== formData.confirmPassword) {\r\n+      setError(\"New passwords do not match.\");\r\n+      return;\r\n+    }\r\n+\r\n+    const payload = {\r\n+      name: formData.name,\r\n+      email: formData.email,\r\n+      phone: formData.phone,\r\n+      region: formData.region,\r\n+      children: formData.children,\r\n+    };\r\n+\r\n+    if (formData.newPassword) {\r\n+      payload.password = formData.newPassword;\r\n+    }\r\n+\r\n+    try {\r\n+      await updateClientProfile(payload, token);\r\n+      setShowSuccess(true);\r\n+      setTimeout(() => setShowSuccess(false), 3000);\r\n+    } catch (err) {\r\n+      console.error(err);\r\n+      setError(\"Failed to update profile.\");\r\n+    }\r\n   };\r\n \r\n-  // Confirm account deletion\r\n   const confirmDelete = async () => {\r\n     try {\r\n-      await axios.delete(\"http://localhost:3000/api/users/profile\", {\r\n-        headers: {\r\n-          Authorization: `Bearer ${token}`,\r\n-        },\r\n-      });\r\n+      await deleteClientAccount(token);\r\n       logout();\r\n       navigate(\"/\");\r\n-    } catch (error) {\r\n-      console.error(\"Error deleting account:\", error);\r\n-      alert(\"Failed to delete account. Please try again.\");\r\n+    } catch (err) {\r\n+      console.error(err);\r\n+      alert(\"Failed to delete account.\");\r\n     }\r\n   };\r\n \r\n   return (\r\n     <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n       <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n \r\n-      <div className=\"max-w-xl mx-auto bg-white p-6 rounded-2xl shadow\">\r\n+      <div className=\"max-w-xl mx-auto bg-white p-6 rounded-xl shadow\">\r\n         {showSuccess && (\r\n           <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded text-center flex items-center justify-center gap-2\">\r\n             <FaCheckCircle />\r\n             <span>Profile updated successfully!</span>\r\n           </div>\r\n         )}\r\n+        {error && (\r\n+          <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded text-center\">\r\n+            {error}\r\n+          </div>\r\n+        )}\r\n \r\n         <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n           <input\r\n+            name=\"name\"\r\n+            value={formData.name}\r\n+            onChange={handleChange}\r\n             type=\"text\"\r\n             placeholder=\"Full Name\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n           <input\r\n+            name=\"email\"\r\n+            value={formData.email}\r\n+            onChange={handleChange}\r\n             type=\"email\"\r\n             placeholder=\"Email Address\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n           <input\r\n+            name=\"phone\"\r\n+            value={formData.phone}\r\n+            onChange={handleChange}\r\n             type=\"text\"\r\n             placeholder=\"Phone Number\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n-\r\n-          {/* Region */}\r\n-          <select className=\"w-full px-4 py-2 border rounded focus:outline-none\">\r\n+          <select\r\n+            name=\"region\"\r\n+            value={formData.region}\r\n+            onChange={handleChange}\r\n+            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+          >\r\n             <option value=\"\">Select Region</option>\r\n             <option value=\"Central\">Central</option>\r\n             <option value=\"East\">East</option>\r\n             <option value=\"West\">West</option>\r\n             <option value=\"North\">North</option>\r\n             <option value=\"South\">South</option>\r\n           </select>\r\n-\r\n-          {/* Number of Children */}\r\n           <input\r\n+            name=\"children\"\r\n+            value={formData.children}\r\n+            onChange={handleChange}\r\n             type=\"number\"\r\n-            min=\"1\"\r\n             placeholder=\"Number of Children\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n \r\n           {/* Change Password */}\r\n           <div className=\"border-t pt-4 mt-4\">\r\n             <h2 className=\"text-lg font-semibold mb-2\">Change Password</h2>\r\n             <input\r\n+              name=\"currentPassword\"\r\n+              value={formData.currentPassword}\r\n+              onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"Current Password\"\r\n               className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n             />\r\n             <input\r\n+              name=\"newPassword\"\r\n+              value={formData.newPassword}\r\n+              onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"New Password\"\r\n               className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n             />\r\n             <input\r\n+              name=\"confirmPassword\"\r\n+              value={formData.confirmPassword}\r\n+              onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"Confirm New Password\"\r\n               className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n             />\r\n@@ -106,9 +168,8 @@\n             className=\"w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded transition\"\r\n           >\r\n             Save Changes\r\n           </button>\r\n-\r\n           <button\r\n             type=\"button\"\r\n             onClick={() => setShowConfirm(true)}\r\n             className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded transition mt-2\"\r\n@@ -117,9 +178,8 @@\n           </button>\r\n         </form>\r\n       </div>\r\n \r\n-      {/* Confirmation Modal */}\r\n       {showConfirm && (\r\n         <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n           <div className=\"bg-white rounded-lg shadow-lg p-6 w-full max-w-md text-center\">\r\n             <h2 className=\"text-xl font-semibold mb-4\">Confirm Account Deletion</h2>\r\n"
                },
                {
                    "date": 1751278274439,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import { FaCheckCircle } from \"react-icons/fa\";\r\n import { AuthContext } from \"../context/AuthContext\";\r\n import { useNavigate } from \"react-router-dom\";\r\n import { updateClientProfile, deleteClientAccount } from \"../services/api\";\r\n+import axios from \"axios\";\r\n \r\n const ProfileClient = () => {\r\n   const { user, token, logout } = useContext(AuthContext);\r\n   const navigate = useNavigate();\r\n@@ -31,28 +32,56 @@\n   const handleSubmit = async (e) => {\r\n     e.preventDefault();\r\n     setError(\"\");\r\n \r\n-    if (formData.newPassword && formData.newPassword !== formData.confirmPassword) {\r\n-      setError(\"New passwords do not match.\");\r\n-      return;\r\n+    // Validate passwords\r\n+    if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n+      if (!formData.currentPassword) {\r\n+        setError(\"Please enter your current password to change it.\");\r\n+        return;\r\n+      }\r\n+      if (!formData.newPassword || !formData.confirmPassword) {\r\n+        setError(\"Please fill in all password fields.\");\r\n+        return;\r\n+      }\r\n+      if (formData.newPassword !== formData.confirmPassword) {\r\n+        setError(\"New passwords do not match.\");\r\n+        return;\r\n+      }\r\n     }\r\n \r\n-    const payload = {\r\n-      name: formData.name,\r\n-      email: formData.email,\r\n-      phone: formData.phone,\r\n-      region: formData.region,\r\n-      children: formData.children,\r\n-    };\r\n+    try {\r\n+      // Update profile info\r\n+      const payload = {\r\n+        name: formData.name,\r\n+        email: formData.email,\r\n+        phone: formData.phone,\r\n+        region: formData.region,\r\n+        children: formData.children,\r\n+      };\r\n+      await updateClientProfile(payload, token);\r\n \r\n-    if (formData.newPassword) {\r\n-      payload.password = formData.newPassword;\r\n-    }\r\n+      // Update password if provided\r\n+      if (formData.newPassword) {\r\n+        await axios.put(\r\n+          \"http://localhost:3000/api/users/profile/password\",\r\n+          {\r\n+            currentPassword: formData.currentPassword,\r\n+            newPassword: formData.newPassword,\r\n+          },\r\n+          {\r\n+            headers: { Authorization: `Bearer ${token}` },\r\n+          }\r\n+        );\r\n+      }\r\n \r\n-    try {\r\n-      await updateClientProfile(payload, token);\r\n       setShowSuccess(true);\r\n+      setFormData((prev) => ({\r\n+        ...prev,\r\n+        currentPassword: \"\",\r\n+        newPassword: \"\",\r\n+        confirmPassword: \"\",\r\n+      }));\r\n       setTimeout(() => setShowSuccess(false), 3000);\r\n     } catch (err) {\r\n       console.error(err);\r\n       setError(\"Failed to update profile.\");\r\n"
                },
                {
                    "date": 1751279550636,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,67 +29,71 @@\n     setFormData((prev) => ({ ...prev, [name]: value }));\r\n   };\r\n \r\n   const handleSubmit = async (e) => {\r\n-    e.preventDefault();\r\n-    setError(\"\");\r\n+  e.preventDefault();\r\n+  setError(\"\");\r\n \r\n-    // Validate passwords\r\n-    if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n-      if (!formData.currentPassword) {\r\n-        setError(\"Please enter your current password to change it.\");\r\n-        return;\r\n-      }\r\n-      if (!formData.newPassword || !formData.confirmPassword) {\r\n-        setError(\"Please fill in all password fields.\");\r\n-        return;\r\n-      }\r\n-      if (formData.newPassword !== formData.confirmPassword) {\r\n-        setError(\"New passwords do not match.\");\r\n-        return;\r\n-      }\r\n+  // Validate passwords\r\n+  if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n+    if (!formData.currentPassword) {\r\n+      setError(\"Please enter your current password to change it.\");\r\n+      return;\r\n     }\r\n+    if (!formData.newPassword || !formData.confirmPassword) {\r\n+      setError(\"Please fill in all password fields.\");\r\n+      return;\r\n+    }\r\n+    if (formData.newPassword !== formData.confirmPassword) {\r\n+      setError(\"New passwords do not match.\");\r\n+      return;\r\n+    }\r\n+  }\r\n \r\n-    try {\r\n-      // Update profile info\r\n-      const payload = {\r\n-        name: formData.name,\r\n-        email: formData.email,\r\n-        phone: formData.phone,\r\n-        region: formData.region,\r\n-        children: formData.children,\r\n-      };\r\n-      await updateClientProfile(payload, token);\r\n+  try {\r\n+    // Update profile info\r\n+    const payload = {\r\n+      name: formData.name,\r\n+      email: formData.email,\r\n+      phone: formData.phone,\r\n+      region: formData.region,\r\n+      children: formData.children,\r\n+    };\r\n+    await updateClientProfile(payload, token);\r\n \r\n-      // Update password if provided\r\n-      if (formData.newPassword) {\r\n-        await axios.put(\r\n-          \"http://localhost:3000/api/users/profile/password\",\r\n-          {\r\n-            currentPassword: formData.currentPassword,\r\n-            newPassword: formData.newPassword,\r\n-          },\r\n-          {\r\n-            headers: { Authorization: `Bearer ${token}` },\r\n-          }\r\n-        );\r\n-      }\r\n+    // Update password if provided\r\n+    if (formData.newPassword) {\r\n+      await axios.put(\r\n+        \"http://localhost:3000/api/users/profile/password\",\r\n+        {\r\n+          currentPassword: formData.currentPassword,\r\n+          newPassword: formData.newPassword,\r\n+        },\r\n+        {\r\n+          headers: { Authorization: `Bearer ${token}` },\r\n+        }\r\n+      );\r\n+    }\r\n \r\n-      setShowSuccess(true);\r\n-      setFormData((prev) => ({\r\n-        ...prev,\r\n-        currentPassword: \"\",\r\n-        newPassword: \"\",\r\n-        confirmPassword: \"\",\r\n-      }));\r\n-      setTimeout(() => setShowSuccess(false), 3000);\r\n-    } catch (err) {\r\n-      console.error(err);\r\n+    setShowSuccess(true);\r\n+    setFormData((prev) => ({\r\n+      ...prev,\r\n+      currentPassword: \"\",\r\n+      newPassword: \"\",\r\n+      confirmPassword: \"\",\r\n+    }));\r\n+    setTimeout(() => setShowSuccess(false), 3000);\r\n+  } catch (err) {\r\n+    console.error(err);\r\n+    if (err.response && err.response.data && err.response.data.error) {\r\n+      setError(err.response.data.error);\r\n+    } else {\r\n       setError(\"Failed to update profile.\");\r\n     }\r\n-  };\r\n+  }\r\n+};\r\n \r\n-  const confirmDelete = async () => {\r\n+const confirmDelete = async () => {\r\n     try {\r\n       await deleteClientAccount(token);\r\n       logout();\r\n       navigate(\"/\");\r\n"
                },
                {
                    "date": 1751577775063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,11 +11,12 @@\n \r\n   const [formData, setFormData] = useState({\r\n     name: user?.name || \"\",\r\n     email: user?.email || \"\",\r\n-    phone: \"\",\r\n-    region: \"\",\r\n-    children: \"\",\r\n+    phone: user?.phone || \"\",\r\n+    region: user?.region || \"\",\r\n+    children_count: user?.children_count || \"\",\r\n+    address: user?.address || \"\",\r\n     currentPassword: \"\",\r\n     newPassword: \"\",\r\n     confirmPassword: \"\",\r\n   });\r\n@@ -23,77 +24,81 @@\n   const [showSuccess, setShowSuccess] = useState(false);\r\n   const [showConfirm, setShowConfirm] = useState(false);\r\n   const [error, setError] = useState(\"\");\r\n \r\n+  // Handle input changes\r\n   const handleChange = (e) => {\r\n     const { name, value } = e.target;\r\n     setFormData((prev) => ({ ...prev, [name]: value }));\r\n   };\r\n \r\n+  // Handle form submit\r\n   const handleSubmit = async (e) => {\r\n-  e.preventDefault();\r\n-  setError(\"\");\r\n+    e.preventDefault();\r\n+    setError(\"\");\r\n \r\n-  // Validate passwords\r\n-  if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n-    if (!formData.currentPassword) {\r\n-      setError(\"Please enter your current password to change it.\");\r\n-      return;\r\n+    // Validate passwords if any field is filled\r\n+    if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n+      if (!formData.currentPassword) {\r\n+        setError(\"Please enter your current password to change it.\");\r\n+        return;\r\n+      }\r\n+      if (!formData.newPassword || !formData.confirmPassword) {\r\n+        setError(\"Please fill in all password fields.\");\r\n+        return;\r\n+      }\r\n+      if (formData.newPassword !== formData.confirmPassword) {\r\n+        setError(\"New passwords do not match.\");\r\n+        return;\r\n+      }\r\n     }\r\n-    if (!formData.newPassword || !formData.confirmPassword) {\r\n-      setError(\"Please fill in all password fields.\");\r\n-      return;\r\n-    }\r\n-    if (formData.newPassword !== formData.confirmPassword) {\r\n-      setError(\"New passwords do not match.\");\r\n-      return;\r\n-    }\r\n-  }\r\n \r\n-  try {\r\n-    // Update profile info\r\n-    const payload = {\r\n-      name: formData.name,\r\n-      email: formData.email,\r\n-      phone: formData.phone,\r\n-      region: formData.region,\r\n-      children: formData.children,\r\n-    };\r\n-    await updateClientProfile(payload, token);\r\n+    try {\r\n+      // Update profile fields\r\n+      const payload = {\r\n+        name: formData.name,\r\n+        email: formData.email,\r\n+        phone: formData.phone,\r\n+        region: formData.region,\r\n+        children_count: formData.children_count,\r\n+        address: formData.address,\r\n+      };\r\n+      await updateClientProfile(payload, token);\r\n \r\n-    // Update password if provided\r\n-    if (formData.newPassword) {\r\n-      await axios.put(\r\n-        \"http://localhost:3000/api/users/profile/password\",\r\n-        {\r\n-          currentPassword: formData.currentPassword,\r\n-          newPassword: formData.newPassword,\r\n-        },\r\n-        {\r\n-          headers: { Authorization: `Bearer ${token}` },\r\n-        }\r\n-      );\r\n-    }\r\n+      // Update password if provided\r\n+      if (formData.newPassword) {\r\n+        await axios.put(\r\n+          \"http://localhost:3000/api/users/profile/password\",\r\n+          {\r\n+            currentPassword: formData.currentPassword,\r\n+            newPassword: formData.newPassword,\r\n+          },\r\n+          {\r\n+            headers: { Authorization: `Bearer ${token}` },\r\n+          }\r\n+        );\r\n+      }\r\n \r\n-    setShowSuccess(true);\r\n-    setFormData((prev) => ({\r\n-      ...prev,\r\n-      currentPassword: \"\",\r\n-      newPassword: \"\",\r\n-      confirmPassword: \"\",\r\n-    }));\r\n-    setTimeout(() => setShowSuccess(false), 3000);\r\n-  } catch (err) {\r\n-    console.error(err);\r\n-    if (err.response && err.response.data && err.response.data.error) {\r\n-      setError(err.response.data.error);\r\n-    } else {\r\n-      setError(\"Failed to update profile.\");\r\n+      setShowSuccess(true);\r\n+      setFormData((prev) => ({\r\n+        ...prev,\r\n+        currentPassword: \"\",\r\n+        newPassword: \"\",\r\n+        confirmPassword: \"\",\r\n+      }));\r\n+      setTimeout(() => setShowSuccess(false), 3000);\r\n+    } catch (err) {\r\n+      console.error(err);\r\n+      if (err.response && err.response.data && err.response.data.error) {\r\n+        setError(err.response.data.error);\r\n+      } else {\r\n+        setError(\"Failed to update profile.\");\r\n+      }\r\n     }\r\n-  }\r\n-};\r\n+  };\r\n \r\n-const confirmDelete = async () => {\r\n+  // Handle account deletion\r\n+  const confirmDelete = async () => {\r\n     try {\r\n       await deleteClientAccount(token);\r\n       logout();\r\n       navigate(\"/\");\r\n@@ -144,8 +149,16 @@\n             type=\"text\"\r\n             placeholder=\"Phone Number\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n           />\r\n+          <input\r\n+            name=\"address\"\r\n+            value={formData.address}\r\n+            onChange={handleChange}\r\n+            type=\"text\"\r\n+            placeholder=\"Address\"\r\n+            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+          />\r\n           <select\r\n             name=\"region\"\r\n             value={formData.region}\r\n             onChange={handleChange}\r\n@@ -158,10 +171,10 @@\n             <option value=\"North\">North</option>\r\n             <option value=\"South\">South</option>\r\n           </select>\r\n           <input\r\n-            name=\"children\"\r\n-            value={formData.children}\r\n+            name=\"children_count\"\r\n+            value={formData.children_count}\r\n             onChange={handleChange}\r\n             type=\"number\"\r\n             placeholder=\"Number of Children\"\r\n             className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n"
                },
                {
                    "date": 1751578529201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,25 +77,37 @@\n           }\r\n         );\r\n       }\r\n \r\n+      // Update localStorage and context\r\n+      const updatedUser = {\r\n+        ...user,\r\n+        name: payload.name,\r\n+        email: payload.email,\r\n+        phone: payload.phone,\r\n+        region: payload.region,\r\n+        children_count: payload.children_count,\r\n+        address: payload.address\r\n+      };\r\n+      localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n+\r\n       setShowSuccess(true);\r\n       setFormData((prev) => ({\r\n         ...prev,\r\n         currentPassword: \"\",\r\n         newPassword: \"\",\r\n         confirmPassword: \"\",\r\n       }));\r\n       setTimeout(() => setShowSuccess(false), 3000);\r\n-    } catch (err) {\r\n-      console.error(err);\r\n-      if (err.response && err.response.data && err.response.data.error) {\r\n-        setError(err.response.data.error);\r\n-      } else {\r\n-        setError(\"Failed to update profile.\");\r\n-      }\r\n-    }\r\n-  };\r\n+          } catch (err) {\r\n+            console.error(err);\r\n+            if (err.response && err.response.data && err.response.data.error) {\r\n+              setError(err.response.data.error);\r\n+            } else {\r\n+              setError(\"Failed to update profile.\");\r\n+            }\r\n+          }\r\n+        };\r\n \r\n   // Handle account deletion\r\n   const confirmDelete = async () => {\r\n     try {\r\n"
                },
                {
                    "date": 1751579483337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,15 +89,22 @@\n         address: payload.address\r\n       };\r\n       localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n \r\n-      setShowSuccess(true);\r\n-      setFormData((prev) => ({\r\n-        ...prev,\r\n+     // Update formData to reflect changes immediately\r\n+      setFormData({\r\n+        name: updatedUser.name || \"\",\r\n+        email: updatedUser.email || \"\",\r\n+        phone: updatedUser.phone || \"\",\r\n+        region: updatedUser.region || \"\",\r\n+        children_count: updatedUser.children_count || \"\",\r\n+        address: updatedUser.address || \"\",\r\n         currentPassword: \"\",\r\n         newPassword: \"\",\r\n         confirmPassword: \"\",\r\n-      }));\r\n+      });\r\n+\r\n+      setShowSuccess(true);\r\n       setTimeout(() => setShowSuccess(false), 3000);\r\n           } catch (err) {\r\n             console.error(err);\r\n             if (err.response && err.response.data && err.response.data.error) {\r\n@@ -107,23 +114,23 @@\n             }\r\n           }\r\n         };\r\n \r\n-  // Handle account deletion\r\n-  const confirmDelete = async () => {\r\n-    try {\r\n-      await deleteClientAccount(token);\r\n-      logout();\r\n-      navigate(\"/\");\r\n-    } catch (err) {\r\n-      console.error(err);\r\n-      alert(\"Failed to delete account.\");\r\n-    }\r\n-  };\r\n+      // Handle account deletion\r\n+      const confirmDelete = async () => {\r\n+        try {\r\n+          await deleteClientAccount(token);\r\n+          logout();\r\n+          navigate(\"/\");\r\n+        } catch (err) {\r\n+          console.error(err);\r\n+          alert(\"Failed to delete account.\");\r\n+        }\r\n+      };\r\n \r\n-  return (\r\n-    <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n-      <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n+      return (\r\n+        <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n+          <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n \r\n       <div className=\"max-w-xl mx-auto bg-white p-6 rounded-xl shadow\">\r\n         {showSuccess && (\r\n           <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded text-center flex items-center justify-center gap-2\">\r\n"
                },
                {
                    "date": 1751581195728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import React, { useState, useContext } from \"react\";\r\n+import React, { useState, useContext, useEffect } from \"react\";\r\n import { FaCheckCircle } from \"react-icons/fa\";\r\n import { AuthContext } from \"../context/AuthContext\";\r\n import { useNavigate } from \"react-router-dom\";\r\n import { updateClientProfile, deleteClientAccount } from \"../services/api\";\r\n@@ -8,31 +8,59 @@\n const ProfileClient = () => {\r\n   const { user, token, logout } = useContext(AuthContext);\r\n   const navigate = useNavigate();\r\n \r\n+  // Form state\r\n   const [formData, setFormData] = useState({\r\n-    name: user?.name || \"\",\r\n-    email: user?.email || \"\",\r\n-    phone: user?.phone || \"\",\r\n-    region: user?.region || \"\",\r\n-    children_count: user?.children_count || \"\",\r\n-    address: user?.address || \"\",\r\n+    name: \"\",\r\n+    email: \"\",\r\n+    phone: \"\",\r\n+    region: \"\",\r\n+    address: \"\",\r\n+    children_count: \"\",\r\n     currentPassword: \"\",\r\n     newPassword: \"\",\r\n-    confirmPassword: \"\",\r\n+    confirmPassword: \"\"\r\n   });\r\n \r\n+  // Success and error state\r\n   const [showSuccess, setShowSuccess] = useState(false);\r\n   const [showConfirm, setShowConfirm] = useState(false);\r\n   const [error, setError] = useState(\"\");\r\n \r\n+  // Fetch profile data when component mounts\r\n+  useEffect(() => {\r\n+    const fetchProfile = async () => {\r\n+      try {\r\n+        const res = await axios.get(\"http://localhost:3000/api/users/profile\", {\r\n+          headers: { Authorization: `Bearer ${token}` }\r\n+        });\r\n+        setFormData({\r\n+          name: res.data.name || \"\",\r\n+          email: res.data.email || \"\",\r\n+          phone: res.data.phone || \"\",\r\n+          region: res.data.region || \"\",\r\n+          address: res.data.address || \"\",\r\n+          children_count: res.data.children_count || \"\",\r\n+          currentPassword: \"\",\r\n+          newPassword: \"\",\r\n+          confirmPassword: \"\"\r\n+        });\r\n+      } catch (error) {\r\n+        console.error(\"Error fetching profile:\", error);\r\n+      }\r\n+    };\r\n+\r\n+    fetchProfile();\r\n+  }, [token]);\r\n+\r\n   // Handle input changes\r\n   const handleChange = (e) => {\r\n     const { name, value } = e.target;\r\n     setFormData((prev) => ({ ...prev, [name]: value }));\r\n   };\r\n \r\n-  // Handle form submit\r\n+  // Handle profile update\r\n   const handleSubmit = async (e) => {\r\n     e.preventDefault();\r\n     setError(\"\");\r\n \r\n@@ -58,10 +86,11 @@\n         name: formData.name,\r\n         email: formData.email,\r\n         phone: formData.phone,\r\n         region: formData.region,\r\n-        children_count: formData.children_count,\r\n         address: formData.address,\r\n+        children_count:\r\n+          formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n       };\r\n       await updateClientProfile(payload, token);\r\n \r\n       // Update password if provided\r\n@@ -77,60 +106,42 @@\n           }\r\n         );\r\n       }\r\n \r\n-      // Update localStorage and context\r\n-      const updatedUser = {\r\n-        ...user,\r\n-        name: payload.name,\r\n-        email: payload.email,\r\n-        phone: payload.phone,\r\n-        region: payload.region,\r\n-        children_count: payload.children_count,\r\n-        address: payload.address\r\n-      };\r\n-      localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n-\r\n-     // Update formData to reflect changes immediately\r\n-      setFormData({\r\n-        name: updatedUser.name || \"\",\r\n-        email: updatedUser.email || \"\",\r\n-        phone: updatedUser.phone || \"\",\r\n-        region: updatedUser.region || \"\",\r\n-        children_count: updatedUser.children_count || \"\",\r\n-        address: updatedUser.address || \"\",\r\n+      // Show success and clear password fields\r\n+      setShowSuccess(true);\r\n+      setFormData((prev) => ({\r\n+        ...prev,\r\n         currentPassword: \"\",\r\n         newPassword: \"\",\r\n-        confirmPassword: \"\",\r\n-      });\r\n-\r\n-      setShowSuccess(true);\r\n+        confirmPassword: \"\"\r\n+      }));\r\n       setTimeout(() => setShowSuccess(false), 3000);\r\n-          } catch (err) {\r\n-            console.error(err);\r\n-            if (err.response && err.response.data && err.response.data.error) {\r\n-              setError(err.response.data.error);\r\n-            } else {\r\n-              setError(\"Failed to update profile.\");\r\n-            }\r\n-          }\r\n-        };\r\n+    } catch (err) {\r\n+      console.error(err);\r\n+      if (err.response && err.response.data && err.response.data.error) {\r\n+        setError(err.response.data.error);\r\n+      } else {\r\n+        setError(\"Failed to update profile.\");\r\n+      }\r\n+    }\r\n+  };\r\n \r\n-      // Handle account deletion\r\n-      const confirmDelete = async () => {\r\n-        try {\r\n-          await deleteClientAccount(token);\r\n-          logout();\r\n-          navigate(\"/\");\r\n-        } catch (err) {\r\n-          console.error(err);\r\n-          alert(\"Failed to delete account.\");\r\n-        }\r\n-      };\r\n+  // Handle account deletion\r\n+  const confirmDelete = async () => {\r\n+    try {\r\n+      await deleteClientAccount(token);\r\n+      logout();\r\n+      navigate(\"/\");\r\n+    } catch (err) {\r\n+      console.error(err);\r\n+      alert(\"Failed to delete account.\");\r\n+    }\r\n+  };\r\n \r\n-      return (\r\n-        <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n-          <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n+  return (\r\n+    <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n+      <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n \r\n       <div className=\"max-w-xl mx-auto bg-white p-6 rounded-xl shadow\">\r\n         {showSuccess && (\r\n           <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded text-center flex items-center justify-center gap-2\">\r\n"
                },
                {
                    "date": 1751601589391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,16 @@\n         address: formData.address,\r\n         children_count:\r\n           formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n       };\r\n-      await updateClientProfile(payload, token);\r\n+      const updatedUser = await updateClientProfile(payload, token);\r\n+        login({\r\n+          token,\r\n+          user: {\r\n+            ...updatedUser,\r\n+            role: \"user\"\r\n+          }\r\n+        });\r\n \r\n       // Update password if provided\r\n       if (formData.newPassword) {\r\n         await axios.put(\r\n"
                },
                {
                    "date": 1751601937952,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,16 +82,19 @@\n \r\n     try {\r\n       // Update profile fields\r\n       const payload = {\r\n-        name: formData.name,\r\n-        email: formData.email,\r\n-        phone: formData.phone,\r\n-        region: formData.region,\r\n-        address: formData.address,\r\n-        children_count:\r\n-          formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n-      };\r\n+      name: formData.name || null,\r\n+      email: formData.email || null,\r\n+      phone: formData.phone || null,\r\n+      region: formData.region || null,\r\n+      address: formData.address || null,\r\n+      children_count:\r\n+        formData.children_count === \"\" || formData.children_count === undefined\r\n+          ? null\r\n+          : parseInt(formData.children_count, 10)\r\n+    };\r\n+\r\n       const updatedUser = await updateClientProfile(payload, token);\r\n         login({\r\n           token,\r\n           user: {\r\n"
                },
                {
                    "date": 1751602113377,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,28 +82,18 @@\n \r\n     try {\r\n       // Update profile fields\r\n       const payload = {\r\n-      name: formData.name || null,\r\n-      email: formData.email || null,\r\n-      phone: formData.phone || null,\r\n-      region: formData.region || null,\r\n-      address: formData.address || null,\r\n-      children_count:\r\n-        formData.children_count === \"\" || formData.children_count === undefined\r\n-          ? null\r\n-          : parseInt(formData.children_count, 10)\r\n-    };\r\n+        name: formData.name,\r\n+        email: formData.email,\r\n+        phone: formData.phone,\r\n+        region: formData.region,\r\n+        address: formData.address,\r\n+        children_count:\r\n+          formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n+      };\r\n+      await updateClientProfile(payload, token);\r\n \r\n-      const updatedUser = await updateClientProfile(payload, token);\r\n-        login({\r\n-          token,\r\n-          user: {\r\n-            ...updatedUser,\r\n-            role: \"user\"\r\n-          }\r\n-        });\r\n-\r\n       // Update password if provided\r\n       if (formData.newPassword) {\r\n         await axios.put(\r\n           \"http://localhost:3000/api/users/profile/password\",\r\n"
                },
                {
                    "date": 1751602798846,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,16 +1,14 @@\n import React, { useState, useContext, useEffect } from \"react\";\r\n import { FaCheckCircle } from \"react-icons/fa\";\r\n import { AuthContext } from \"../context/AuthContext\";\r\n import { useNavigate } from \"react-router-dom\";\r\n-import { updateClientProfile, deleteClientAccount } from \"../services/api\";\r\n import axios from \"axios\";\r\n \r\n const ProfileClient = () => {\r\n-  const { user, token, logout } = useContext(AuthContext);\r\n+  const { token, logout } = useContext(AuthContext);\r\n   const navigate = useNavigate();\r\n \r\n-  // Form state\r\n   const [formData, setFormData] = useState({\r\n     name: \"\",\r\n     email: \"\",\r\n     phone: \"\",\r\n@@ -21,14 +19,13 @@\n     newPassword: \"\",\r\n     confirmPassword: \"\"\r\n   });\r\n \r\n-  // Success and error state\r\n   const [showSuccess, setShowSuccess] = useState(false);\r\n   const [showConfirm, setShowConfirm] = useState(false);\r\n   const [error, setError] = useState(\"\");\r\n \r\n-  // Fetch profile data when component mounts\r\n+  // Fetch profile data\r\n   useEffect(() => {\r\n     const fetchProfile = async () => {\r\n       try {\r\n         const res = await axios.get(\"http://localhost:3000/api/users/profile\", {\r\n@@ -44,28 +41,25 @@\n           currentPassword: \"\",\r\n           newPassword: \"\",\r\n           confirmPassword: \"\"\r\n         });\r\n-      } catch (error) {\r\n-        console.error(\"Error fetching profile:\", error);\r\n+      } catch (err) {\r\n+        console.error(\"Error fetching profile:\", err);\r\n       }\r\n     };\r\n \r\n     fetchProfile();\r\n   }, [token]);\r\n \r\n-  // Handle input changes\r\n   const handleChange = (e) => {\r\n     const { name, value } = e.target;\r\n     setFormData((prev) => ({ ...prev, [name]: value }));\r\n   };\r\n \r\n-  // Handle profile update\r\n   const handleSubmit = async (e) => {\r\n     e.preventDefault();\r\n     setError(\"\");\r\n \r\n-    // Validate passwords if any field is filled\r\n     if (formData.newPassword || formData.confirmPassword || formData.currentPassword) {\r\n       if (!formData.currentPassword) {\r\n         setError(\"Please enter your current password to change it.\");\r\n         return;\r\n@@ -80,35 +74,35 @@\n       }\r\n     }\r\n \r\n     try {\r\n-      // Update profile fields\r\n-      const payload = {\r\n-        name: formData.name,\r\n-        email: formData.email,\r\n-        phone: formData.phone,\r\n-        region: formData.region,\r\n-        address: formData.address,\r\n-        children_count:\r\n-          formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n-      };\r\n-      await updateClientProfile(payload, token);\r\n+      // Update profile\r\n+      await axios.put(\r\n+        \"http://localhost:3000/api/users/profile\",\r\n+        {\r\n+          name: formData.name,\r\n+          email: formData.email,\r\n+          phone: formData.phone,\r\n+          region: formData.region,\r\n+          address: formData.address,\r\n+          children_count:\r\n+            formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n+        },\r\n+        { headers: { Authorization: `Bearer ${token}` } }\r\n+      );\r\n \r\n       // Update password if provided\r\n       if (formData.newPassword) {\r\n         await axios.put(\r\n           \"http://localhost:3000/api/users/profile/password\",\r\n           {\r\n             currentPassword: formData.currentPassword,\r\n-            newPassword: formData.newPassword,\r\n+            newPassword: formData.newPassword\r\n           },\r\n-          {\r\n-            headers: { Authorization: `Bearer ${token}` },\r\n-          }\r\n+          { headers: { Authorization: `Bearer ${token}` } }\r\n         );\r\n       }\r\n \r\n-      // Show success and clear password fields\r\n       setShowSuccess(true);\r\n       setFormData((prev) => ({\r\n         ...prev,\r\n         currentPassword: \"\",\r\n@@ -117,20 +111,21 @@\n       }));\r\n       setTimeout(() => setShowSuccess(false), 3000);\r\n     } catch (err) {\r\n       console.error(err);\r\n-      if (err.response && err.response.data && err.response.data.error) {\r\n+      if (err.response?.data?.error) {\r\n         setError(err.response.data.error);\r\n       } else {\r\n         setError(\"Failed to update profile.\");\r\n       }\r\n     }\r\n   };\r\n \r\n-  // Handle account deletion\r\n   const confirmDelete = async () => {\r\n     try {\r\n-      await deleteClientAccount(token);\r\n+      await axios.delete(\"http://localhost:3000/api/users/profile\", {\r\n+        headers: { Authorization: `Bearer ${token}` }\r\n+      });\r\n       logout();\r\n       navigate(\"/\");\r\n     } catch (err) {\r\n       console.error(err);\r\n@@ -161,39 +156,39 @@\n             value={formData.name}\r\n             onChange={handleChange}\r\n             type=\"text\"\r\n             placeholder=\"Full Name\"\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           />\r\n           <input\r\n             name=\"email\"\r\n             value={formData.email}\r\n             onChange={handleChange}\r\n             type=\"email\"\r\n             placeholder=\"Email Address\"\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           />\r\n           <input\r\n             name=\"phone\"\r\n             value={formData.phone}\r\n             onChange={handleChange}\r\n             type=\"text\"\r\n             placeholder=\"Phone Number\"\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           />\r\n           <input\r\n             name=\"address\"\r\n             value={formData.address}\r\n             onChange={handleChange}\r\n             type=\"text\"\r\n             placeholder=\"Address\"\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           />\r\n           <select\r\n             name=\"region\"\r\n             value={formData.region}\r\n             onChange={handleChange}\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           >\r\n             <option value=\"\">Select Region</option>\r\n             <option value=\"Central\">Central</option>\r\n             <option value=\"East\">East</option>\r\n@@ -206,37 +201,36 @@\n             value={formData.children_count}\r\n             onChange={handleChange}\r\n             type=\"number\"\r\n             placeholder=\"Number of Children\"\r\n-            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+            className=\"w-full px-4 py-2 border rounded\"\r\n           />\r\n \r\n-          {/* Change Password */}\r\n           <div className=\"border-t pt-4 mt-4\">\r\n             <h2 className=\"text-lg font-semibold mb-2\">Change Password</h2>\r\n             <input\r\n               name=\"currentPassword\"\r\n               value={formData.currentPassword}\r\n               onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"Current Password\"\r\n-              className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n+              className=\"w-full mb-2 px-4 py-2 border rounded\"\r\n             />\r\n             <input\r\n               name=\"newPassword\"\r\n               value={formData.newPassword}\r\n               onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"New Password\"\r\n-              className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n+              className=\"w-full mb-2 px-4 py-2 border rounded\"\r\n             />\r\n             <input\r\n               name=\"confirmPassword\"\r\n               value={formData.confirmPassword}\r\n               onChange={handleChange}\r\n               type=\"password\"\r\n               placeholder=\"Confirm New Password\"\r\n-              className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n+              className=\"w-full px-4 py-2 border rounded\"\r\n             />\r\n           </div>\r\n \r\n           <button\r\n"
                },
                {
                    "date": 1751603225586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n import React, { useState, useContext, useEffect } from \"react\";\r\n import { FaCheckCircle } from \"react-icons/fa\";\r\n import { AuthContext } from \"../context/AuthContext\";\r\n import { useNavigate } from \"react-router-dom\";\r\n+import { updateClientProfile, deleteClientAccount } from \"../services/api\";\r\n import axios from \"axios\";\r\n \r\n const ProfileClient = () => {\r\n   const { token, logout } = useContext(AuthContext);\r\n@@ -23,28 +24,26 @@\n   const [showSuccess, setShowSuccess] = useState(false);\r\n   const [showConfirm, setShowConfirm] = useState(false);\r\n   const [error, setError] = useState(\"\");\r\n \r\n-  // Fetch profile data\r\n+  // Fetch profile data on mount\r\n   useEffect(() => {\r\n     const fetchProfile = async () => {\r\n       try {\r\n         const res = await axios.get(\"http://localhost:3000/api/users/profile\", {\r\n           headers: { Authorization: `Bearer ${token}` }\r\n         });\r\n-        setFormData({\r\n+        setFormData((prev) => ({\r\n+          ...prev,\r\n           name: res.data.name || \"\",\r\n           email: res.data.email || \"\",\r\n           phone: res.data.phone || \"\",\r\n           region: res.data.region || \"\",\r\n           address: res.data.address || \"\",\r\n-          children_count: res.data.children_count || \"\",\r\n-          currentPassword: \"\",\r\n-          newPassword: \"\",\r\n-          confirmPassword: \"\"\r\n-        });\r\n-      } catch (err) {\r\n-        console.error(\"Error fetching profile:\", err);\r\n+          children_count: res.data.children_count || \"\"\r\n+        }));\r\n+      } catch (error) {\r\n+        console.error(\"Error fetching profile:\", error);\r\n       }\r\n     };\r\n \r\n     fetchProfile();\r\n@@ -74,32 +73,29 @@\n       }\r\n     }\r\n \r\n     try {\r\n-      // Update profile\r\n-      await axios.put(\r\n-        \"http://localhost:3000/api/users/profile\",\r\n-        {\r\n-          name: formData.name,\r\n-          email: formData.email,\r\n-          phone: formData.phone,\r\n-          region: formData.region,\r\n-          address: formData.address,\r\n-          children_count:\r\n-            formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n-        },\r\n-        { headers: { Authorization: `Bearer ${token}` } }\r\n-      );\r\n+      const payload = {\r\n+        name: formData.name,\r\n+        email: formData.email,\r\n+        phone: formData.phone,\r\n+        region: formData.region,\r\n+        address: formData.address,\r\n+        children_count:\r\n+          formData.children_count === \"\" ? null : parseInt(formData.children_count, 10)\r\n+      };\r\n+      await updateClientProfile(payload, token);\r\n \r\n-      // Update password if provided\r\n       if (formData.newPassword) {\r\n         await axios.put(\r\n           \"http://localhost:3000/api/users/profile/password\",\r\n           {\r\n             currentPassword: formData.currentPassword,\r\n             newPassword: formData.newPassword\r\n           },\r\n-          { headers: { Authorization: `Bearer ${token}` } }\r\n+          {\r\n+            headers: { Authorization: `Bearer ${token}` }\r\n+          }\r\n         );\r\n       }\r\n \r\n       setShowSuccess(true);\r\n@@ -121,11 +117,9 @@\n   };\r\n \r\n   const confirmDelete = async () => {\r\n     try {\r\n-      await axios.delete(\"http://localhost:3000/api/users/profile\", {\r\n-        headers: { Authorization: `Bearer ${token}` }\r\n-      });\r\n+      await deleteClientAccount(token);\r\n       logout();\r\n       navigate(\"/\");\r\n     } catch (err) {\r\n       console.error(err);\r\n@@ -135,141 +129,53 @@\n \r\n   return (\r\n     <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n       <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n-\r\n       <div className=\"max-w-xl mx-auto bg-white p-6 rounded-xl shadow\">\r\n         {showSuccess && (\r\n           <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded text-center flex items-center justify-center gap-2\">\r\n             <FaCheckCircle />\r\n             <span>Profile updated successfully!</span>\r\n           </div>\r\n         )}\r\n         {error && (\r\n-          <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded text-center\">\r\n-            {error}\r\n-          </div>\r\n+          <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded text-center\">{error}</div>\r\n         )}\r\n-\r\n         <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n-          <input\r\n-            name=\"name\"\r\n-            value={formData.name}\r\n-            onChange={handleChange}\r\n-            type=\"text\"\r\n-            placeholder=\"Full Name\"\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          />\r\n-          <input\r\n-            name=\"email\"\r\n-            value={formData.email}\r\n-            onChange={handleChange}\r\n-            type=\"email\"\r\n-            placeholder=\"Email Address\"\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          />\r\n-          <input\r\n-            name=\"phone\"\r\n-            value={formData.phone}\r\n-            onChange={handleChange}\r\n-            type=\"text\"\r\n-            placeholder=\"Phone Number\"\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          />\r\n-          <input\r\n-            name=\"address\"\r\n-            value={formData.address}\r\n-            onChange={handleChange}\r\n-            type=\"text\"\r\n-            placeholder=\"Address\"\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          />\r\n-          <select\r\n-            name=\"region\"\r\n-            value={formData.region}\r\n-            onChange={handleChange}\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          >\r\n+          <input name=\"name\" value={formData.name} onChange={handleChange} type=\"text\" placeholder=\"Full Name\" className=\"w-full px-4 py-2 border rounded\" />\r\n+          <input name=\"email\" value={formData.email} onChange={handleChange} type=\"email\" placeholder=\"Email Address\" className=\"w-full px-4 py-2 border rounded\" />\r\n+          <input name=\"phone\" value={formData.phone} onChange={handleChange} type=\"text\" placeholder=\"Phone Number\" className=\"w-full px-4 py-2 border rounded\" />\r\n+          <input name=\"address\" value={formData.address} onChange={handleChange} type=\"text\" placeholder=\"Address\" className=\"w-full px-4 py-2 border rounded\" />\r\n+          <select name=\"region\" value={formData.region} onChange={handleChange} className=\"w-full px-4 py-2 border rounded\">\r\n             <option value=\"\">Select Region</option>\r\n             <option value=\"Central\">Central</option>\r\n             <option value=\"East\">East</option>\r\n             <option value=\"West\">West</option>\r\n             <option value=\"North\">North</option>\r\n             <option value=\"South\">South</option>\r\n           </select>\r\n-          <input\r\n-            name=\"children_count\"\r\n-            value={formData.children_count}\r\n-            onChange={handleChange}\r\n-            type=\"number\"\r\n-            placeholder=\"Number of Children\"\r\n-            className=\"w-full px-4 py-2 border rounded\"\r\n-          />\r\n+          <input name=\"children_count\" value={formData.children_count} onChange={handleChange} type=\"number\" placeholder=\"Number of Children\" className=\"w-full px-4 py-2 border rounded\" />\r\n \r\n           <div className=\"border-t pt-4 mt-4\">\r\n             <h2 className=\"text-lg font-semibold mb-2\">Change Password</h2>\r\n-            <input\r\n-              name=\"currentPassword\"\r\n-              value={formData.currentPassword}\r\n-              onChange={handleChange}\r\n-              type=\"password\"\r\n-              placeholder=\"Current Password\"\r\n-              className=\"w-full mb-2 px-4 py-2 border rounded\"\r\n-            />\r\n-            <input\r\n-              name=\"newPassword\"\r\n-              value={formData.newPassword}\r\n-              onChange={handleChange}\r\n-              type=\"password\"\r\n-              placeholder=\"New Password\"\r\n-              className=\"w-full mb-2 px-4 py-2 border rounded\"\r\n-            />\r\n-            <input\r\n-              name=\"confirmPassword\"\r\n-              value={formData.confirmPassword}\r\n-              onChange={handleChange}\r\n-              type=\"password\"\r\n-              placeholder=\"Confirm New Password\"\r\n-              className=\"w-full px-4 py-2 border rounded\"\r\n-            />\r\n+            <input name=\"currentPassword\" value={formData.currentPassword} onChange={handleChange} type=\"password\" placeholder=\"Current Password\" className=\"w-full mb-2 px-4 py-2 border rounded\" />\r\n+            <input name=\"newPassword\" value={formData.newPassword} onChange={handleChange} type=\"password\" placeholder=\"New Password\" className=\"w-full mb-2 px-4 py-2 border rounded\" />\r\n+            <input name=\"confirmPassword\" value={formData.confirmPassword} onChange={handleChange} type=\"password\" placeholder=\"Confirm New Password\" className=\"w-full px-4 py-2 border rounded\" />\r\n           </div>\r\n \r\n-          <button\r\n-            type=\"submit\"\r\n-            className=\"w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded transition\"\r\n-          >\r\n-            Save Changes\r\n-          </button>\r\n-          <button\r\n-            type=\"button\"\r\n-            onClick={() => setShowConfirm(true)}\r\n-            className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded transition mt-2\"\r\n-          >\r\n-            Delete Account\r\n-          </button>\r\n+          <button type=\"submit\" className=\"w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded transition\">Save Changes</button>\r\n+          <button type=\"button\" onClick={() => setShowConfirm(true)} className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded transition mt-2\">Delete Account</button>\r\n         </form>\r\n       </div>\r\n \r\n       {showConfirm && (\r\n         <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n           <div className=\"bg-white rounded-lg shadow-lg p-6 w-full max-w-md text-center\">\r\n             <h2 className=\"text-xl font-semibold mb-4\">Confirm Account Deletion</h2>\r\n-            <p className=\"mb-6\">\r\n-              Are you sure you want to delete your account? This action cannot be undone.\r\n-            </p>\r\n+            <p className=\"mb-6\">Are you sure you want to delete your account? This action cannot be undone.</p>\r\n             <div className=\"flex justify-center gap-4\">\r\n-              <button\r\n-                onClick={() => setShowConfirm(false)}\r\n-                className=\"px-4 py-2 rounded border border-gray-300 hover:bg-gray-100\"\r\n-              >\r\n-                Cancel\r\n-              </button>\r\n-              <button\r\n-                onClick={confirmDelete}\r\n-                className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\r\n-              >\r\n-                Yes, Delete\r\n-              </button>\r\n+              <button onClick={() => setShowConfirm(false)} className=\"px-4 py-2 rounded border border-gray-300 hover:bg-gray-100\">Cancel</button>\r\n+              <button onClick={confirmDelete} className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\">Yes, Delete</button>\r\n             </div>\r\n           </div>\r\n         </div>\r\n       )}\r\n"
                },
                {
                    "date": 1751605029685,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n           email: res.data.email || \"\",\r\n           phone: res.data.phone || \"\",\r\n           region: res.data.region || \"\",\r\n           address: res.data.address || \"\",\r\n-          children_count: res.data.children_count || \"\"\r\n+          children_count: res.data.children_count !== null && res.data.children_count !== undefined ? res.data.children_count.toString() : \"\",\r\n         }));\r\n       } catch (error) {\r\n         console.error(\"Error fetching profile:\", error);\r\n       }\r\n"
                },
                {
                    "date": 1751605064993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n           email: res.data.email || \"\",\r\n           phone: res.data.phone || \"\",\r\n           region: res.data.region || \"\",\r\n           address: res.data.address || \"\",\r\n-          children_count: res.data.children_count !== null && res.data.children_count !== undefined ? res.data.children_count.toString() : \"\",\r\n+          children_count: res.data.children_count !== null && res.data.children_count !== undefined ? res.data.children_count.toString() : \"\",s\r\n         }));\r\n       } catch (error) {\r\n         console.error(\"Error fetching profile:\", error);\r\n       }\r\n"
                },
                {
                    "date": 1751605239907,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n           email: res.data.email || \"\",\r\n           phone: res.data.phone || \"\",\r\n           region: res.data.region || \"\",\r\n           address: res.data.address || \"\",\r\n-          children_count: res.data.children_count !== null && res.data.children_count !== undefined ? res.data.children_count.toString() : \"\",s\r\n+          children_count: res.data.children_count !== null && res.data.children_count !== undefined ? res.data.children_count.toString() : \"\",\r\n         }));\r\n       } catch (error) {\r\n         console.error(\"Error fetching profile:\", error);\r\n       }\r\n"
                }
            ],
            "date": 1751209680178,
            "name": "Commit-0",
            "content": "// src/pages/ProfileClient.jsx\r\nimport React, { useState, useContext } from \"react\";\r\nimport { FaCheckCircle } from \"react-icons/fa\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nconst ProfileClient = () => {\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [showConfirm, setShowConfirm] = useState(false);\r\n  const { token, logout } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n\r\n  // Handle profile update (mock for now)\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    setShowSuccess(true);\r\n    setTimeout(() => setShowSuccess(false), 3000);\r\n  };\r\n\r\n  // Confirm account deletion\r\n  const confirmDelete = async () => {\r\n    try {\r\n      await axios.delete(\"http://localhost:3000/api/users/profile\", {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      logout();\r\n      navigate(\"/\");\r\n    } catch (error) {\r\n      console.error(\"Error deleting account:\", error);\r\n      alert(\"Failed to delete account. Please try again.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"bg-gradient-to-br from-purple-50 to-purple-100 min-h-screen py-12 px-6\">\r\n      <h1 className=\"text-3xl font-bold text-center mb-8\">Manage Your Profile</h1>\r\n\r\n      <div className=\"max-w-xl mx-auto bg-white p-6 rounded-2xl shadow\">\r\n        {showSuccess && (\r\n          <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded text-center flex items-center justify-center gap-2\">\r\n            <FaCheckCircle />\r\n            <span>Profile updated successfully!</span>\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Full Name\"\r\n            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n          />\r\n          <input\r\n            type=\"email\"\r\n            placeholder=\"Email Address\"\r\n            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Phone Number\"\r\n            className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n          />\r\n\r\n          {/* Change Password */}\r\n          <div className=\"border-t pt-4 mt-4\">\r\n            <h2 className=\"text-lg font-semibold mb-2\">Change Password</h2>\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Current Password\"\r\n              className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n            />\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"New Password\"\r\n              className=\"w-full mb-2 px-4 py-2 border rounded focus:outline-none\"\r\n            />\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Confirm New Password\"\r\n              className=\"w-full px-4 py-2 border rounded focus:outline-none\"\r\n            />\r\n          </div>\r\n\r\n          <button\r\n            type=\"submit\"\r\n            className=\"w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded transition\"\r\n          >\r\n            Save Changes\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setShowConfirm(true)}\r\n            className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded transition mt-2\"\r\n          >\r\n            Delete Account\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      {/* Confirmation Modal */}\r\n      {showConfirm && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 w-full max-w-md text-center\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Confirm Account Deletion</h2>\r\n            <p className=\"mb-6\">\r\n              Are you sure you want to delete your account? This action cannot be undone.\r\n            </p>\r\n            <div className=\"flex justify-center gap-4\">\r\n              <button\r\n                onClick={() => setShowConfirm(false)}\r\n                className=\"px-4 py-2 rounded border border-gray-300 hover:bg-gray-100\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={confirmDelete}\r\n                className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\r\n              >\r\n                Yes, Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default ProfileClient;\r\n"
        }
    ]
}